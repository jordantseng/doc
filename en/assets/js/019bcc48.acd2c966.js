"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[65],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),d=r,h=p["".concat(c,".").concat(d)]||p[d]||m[d]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1053:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var a=n(7462),r=(n(7294),n(3905));const i={},o="Closure",s={unversionedId:"JavaScript/closure",id:"JavaScript/closure",title:"Closure",description:"TL;DR",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/JavaScript/closure.md",sourceDirName:"JavaScript",slug:"/JavaScript/closure",permalink:"/frontendwiz/en/JavaScript/closure",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/JavaScript/closure.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Factory Pattern",permalink:"/frontendwiz/en/Design Patterns/factory-pattern"},next:{title:"Hoisting",permalink:"/frontendwiz/en/JavaScript/hoisting"}},c={},l=[{value:"TL;DR",id:"tldr",level:3},{value:"What is closure",id:"what-is-closure",level:3},{value:"Practical examples",id:"practical-examples",level:3},{value:"Closure vs. Class",id:"closure-vs-class",level:3}],u={toc:l},p="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"closure"},"Closure"),(0,r.kt)("h3",{id:"tldr"},"TL;DR"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A closure is the combination of a function bundled together (enclosed) with references to its surrounding state (the lexical environment)."),(0,r.kt)("li",{parentName:"ul"},"Closure is simply a function that returns another function. The returned function has access to the variables in the outer function's scope, even after the outer function has returned."),(0,r.kt)("li",{parentName:"ul"},"Closures are often used in JavaScript for state persistence, memoization, private variables and curring."),(0,r.kt)("li",{parentName:"ul"},"Closures create functions with private variables and methods that can maintain state, while classes define blueprints for creating objects in JavaScript.")),(0,r.kt)("h3",{id:"what-is-closure"},"What is closure"),(0,r.kt)("p",null,"According to the definition of ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Closures"},"MDN"),", a closure in JavaScript is a combination of a function and the lexical environment where the function was declared."),(0,r.kt)("p",null,"The lexical environment consists of any variables, functions, or other data that were in scope at the time the closure was created."),(0,r.kt)("p",null,"The closure retains a reference to this lexical environment, which allows it to access and manipulate the variables and functions within it, even after the outer function has returned."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"function outerFn() {\n  const name = 'jordan';\n  function innerFn() {\n    console.log(name);\n  }\n  return innerFn;\n}\n\n// lexical environment of outerFn = variable name + function innerFn\n// closure = innerFn + lexical environment of outerFn\nconst innerFn = outerFn();\n\n// because closure retain a reference to the lexical environment of outerFn\n// innerFn is able to access the name variable, even after the outer function has returned\ninnerFn(); // jordan\n")),(0,r.kt)("h3",{id:"practical-examples"},"Practical examples"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"State Persistence")),(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"useState")," function in React is implemented using closures. There is a simplified version of ",(0,r.kt)("inlineCode",{parentName:"p"},"useState")," below."),(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"getState")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"setState")," functions returned by ",(0,r.kt)("inlineCode",{parentName:"p"},"useState")," remember the state variable from the outer scope, allowing them to modify and access it."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"function useState(initialState) {\n  let state = initialState;\n\n  function getState() {\n    return state;\n  }\n\n  function setState(updatedState) {\n    state = updatedState;\n  }\n\n  return [getState, setState];\n}\n\nconst [count, setCount] = useState(0);\n\ncount(); // 0\nsetCount(1);\ncount(); // 1\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Memoization")),(0,r.kt)("p",{parentName:"li"},"Caching mechanisms also utilize the characteristic of closures to remember the outer variables within an inner function."),(0,r.kt)("p",{parentName:"li"},"By storing the computed value in a cache object, the function can return the stored value without recomputing it when the same arguments are used in a subsequent function call."),(0,r.kt)("p",{parentName:"li"},"There is a simplified version of memoize function below, which can only accept primitive values as arguments."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"function memoize(cb) {\n  const cache = {};\n  return function (...args) {\n    const key = JSON.stringify(args);\n\n    if (key in cache) return cache[key];\n\n    const result = cb.apply(this, args);\n\n    cache[key] = result;\n\n    return result;\n  };\n}\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Private Variables")),(0,r.kt)("p",{parentName:"li"},"In JavaScript, there is no built-in support for private variables, but we can use closures to achieve similar functionality."),(0,r.kt)("p",{parentName:"li"},"Closures allows you to create private variables and functions that are not accessible from outside the outer function."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const counter = function () {\n  let privateCounter = 0;\n\n  return {\n    increment() {\n      privateCounter += 1;\n    },\n    decrement() {\n      privateCounter -= 1;\n    },\n    value() {\n      return privateCounter;\n    },\n  };\n};\n\n// privateCounter variable is defined inside the outer function\n// The only way to access privateCounter is by using methods in returned object\n// There is no way to access the privateCounter variable directly from outside the function\n\nconst counter1 = counter();\ncounter1.increment();\ncounter1.value(); // 1\ncounter1.privateCounter; // undefined\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Currying")),(0,r.kt)("p",{parentName:"li"},"Currying is a technique in functional programming where a function with multiple arguments is transformed into a series of functions, each taking a single argument."),(0,r.kt)("p",{parentName:"li"},"Closure is often used to implement currying in JavaScript."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const add = function (x) {\n  return function (y) {\n    return x + y;\n  };\n};\n\n// Calls add function with an argument 1\nconst incrementOne = add(1);\n\n// Calls the incrementOne function, this function always adds 1 to its argument\nincrementOne(2); // 3\n")))),(0,r.kt)("h3",{id:"closure-vs-class"},"Closure vs. Class"),(0,r.kt)("p",null,"Before the introduction of ES6 and the class keyword, JavaScript did not have built-in support for classes."),(0,r.kt)("p",null,"Object-oriented programming (OOP) in JavaScript was typically implemented using functions and closures."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// Closure\nfunction counter() {\n  let count = 0;\n  return {\n    increment: () => count++,\n  };\n}\n\nconst counter1 = counter();\ncounter1.increment(); // 0\ncounter1.increment(); // 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// Class\nclass Counter {\n  constructor() {\n    this.count = 0;\n  }\n  increment() {\n    return this.count++;\n  }\n}\n\nconst counter2 = new Counter();\ncounter2.increment(); // 0\ncounter2.increment(); // 1\n")),(0,r.kt)("p",null,"Closure and classe are similar in that they both can be used to encapsulate state and behavior, but they are different concepts with different purposes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"closure\uff1a",(0,r.kt)("strong",{parentName:"li"},"Closure can be used to encapsulate private variables and methods"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},"Class\uff1a",(0,r.kt)("strong",{parentName:"li"},"A class is a blueprint for creating objects with a specific set of properties and methods."),"\u3002")),(0,r.kt)("p",null,"There is a difference between creating objects with closures and with classes."),(0,r.kt)("p",null,"In JavaScript, closure is created everytime a function is created. As a result, each instance has its own set of variables and methods, and they are not shared between instances."),(0,r.kt)("p",null,"In other hand, class creates a blueprint for creating object. When using class to create instances, they all share the same methods defined in the class"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// using closure to create instances\nconst counter1 = count();\nconst counter2 = count();\n\nconsole.log(counter1.increment === counter2.increment); // false\n\n// using class to create instances\nconst counter3 = new Count();\nconst counter4 = new Count();\nconsole.log(counter3.increment === counter4.increment); // true\n")),(0,r.kt)("p",null,"Reference:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://medium.com/@sustained_salmon_fly_484/javascript%E7%9A%84%E7%89%A9%E4%BB%B6%E5%B0%8E%E5%90%91-closure-new-class-809e0970d566"},"https://medium.com/@sustained_salmon_fly_484/javascript \u7684\u7269\u4ef6\u5c0e\u5411-closure-new-class-809e0970d566"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://www.explainthis.io/en/interview-guides/javascript/what-is-closure"},"https://www.explainthis.io/en/interview-guides/javascript/what-is-closure"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://www.explainthis.io/zh-hant/interview-guides/javascript/what-is-closure"},"https://www.explainthis.io/zh-hant/interview-guides/javascript/what-is-closure")))))}m.isMDXComponent=!0}}]);