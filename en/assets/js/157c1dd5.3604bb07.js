"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[430],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),h=i,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||o;return r?n.createElement(m,a(a({ref:t},c),{},{components:r})):n.createElement(m,a({ref:t},c))}));function m(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=r[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},5938:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=r(7462),i=(r(7294),r(3905));const o={},a="CORS",s={unversionedId:"\u700f\u89bd\u5668/CORS",id:"\u700f\u89bd\u5668/CORS",title:"CORS",description:"TL;DR",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/\u700f\u89bd\u5668/CORS.md",sourceDirName:"\u700f\u89bd\u5668",slug:"/\u700f\u89bd\u5668/CORS",permalink:"/frontendwiz/en/\u700f\u89bd\u5668/CORS",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u700f\u89bd\u5668/CORS.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Selection Sort",permalink:"/frontendwiz/en/\u6f14\u7b97\u6cd5/selection-sort"},next:{title:"\u6e32\u67d3",permalink:"/frontendwiz/en/\u700f\u89bd\u5668/browser-render/"}},l={},p=[{value:"TL;DR",id:"tldr",level:3},{value:"Same Origin",id:"same-origin",level:3},{value:"Same-Origin Policy",id:"same-origin-policy",level:3},{value:"CORS (Cross-Origin Resource Sharing)",id:"cors-cross-origin-resource-sharing",level:3},{value:"How to resolve CORS",id:"how-to-resolve-cors",level:3}],c={toc:p},u="wrapper";function d(e){let{components:t,...r}=e;return(0,i.kt)(u,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"cors"},"CORS"),(0,i.kt)("h3",{id:"tldr"},"TL;DR"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("strong",{parentName:"li"},"Same-Origin Policy")," in browsers prevents websites with different origins from accessing resources of other websites."),(0,i.kt)("li",{parentName:"ul"},"To access resources from a different origin, ",(0,i.kt)("strong",{parentName:"li"},"CORS")," (Cross-Origin Resource Sharing) mechanisms must be used."),(0,i.kt)("li",{parentName:"ul"},"CORS requests are categorized into two types: ",(0,i.kt)("strong",{parentName:"li"},"simple requests")," and ",(0,i.kt)("strong",{parentName:"li"},"preflight requests"),"."),(0,i.kt)("li",{parentName:"ul"},"To resolve CORS issues, the solution is to have the backend engineer configure the server to include the appropriate response headers specifying the allowed origins and methods.")),(0,i.kt)("p",null,"Before understanding what CORS is, it is necessary to know the concepts of ",(0,i.kt)("strong",{parentName:"p"},"protocol"),", ",(0,i.kt)("strong",{parentName:"p"},"domain"),", and ",(0,i.kt)("strong",{parentName:"p"},"port"),", and learn how to determine whether two URLs are of the same origin."),(0,i.kt)("h3",{id:"same-origin"},"Same Origin"),(0,i.kt)("p",null,'For two sources to be considered "same origin", they must meet the following three conditions:'),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Same protocol"),(0,i.kt)("li",{parentName:"ol"},"Same domain"),(0,i.kt)("li",{parentName:"ol"},"Same port")),(0,i.kt)("p",null,"The URL ",(0,i.kt)("inlineCode",{parentName:"p"},"https://jordantseng.github.io:443/frontendwiz/JavaScript")," can be analyzed as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"protocol: ",(0,i.kt)("inlineCode",{parentName:"li"},"https")),(0,i.kt)("li",{parentName:"ul"},"domain: ",(0,i.kt)("inlineCode",{parentName:"li"},"jordantseng.github.io")),(0,i.kt)("li",{parentName:"ul"},"port: ",(0,i.kt)("inlineCode",{parentName:"li"},"443")),(0,i.kt)("li",{parentName:"ul"},"path: ",(0,i.kt)("inlineCode",{parentName:"li"},"frontendwiz/JavaScript"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"// http://jordantseng.github.io => Different protocol, not the same origin.\n// https://jordantseng.github.com => Different domain, not the same origin.\n// https://jordantseng.github.io:5000 => Different port, not the same origin.\n// https://jordantseng.github.io/frontendwiz => Same origin.\n")),(0,i.kt)("h3",{id:"same-origin-policy"},"Same-Origin Policy"),(0,i.kt)("p",null,"The same-origin policy in browsers is the fundamental security mechanism that prevents websites with different origins from accessing resources of other websites."),(0,i.kt)("p",null,"This blocking mechanism occurs in the browser after receiving a response from the server."),(0,i.kt)("h3",{id:"cors-cross-origin-resource-sharing"},"CORS (Cross-Origin Resource Sharing)"),(0,i.kt)("p",null,"In practice, when attempting to access resources from different origins, the browser automatically initiates a CORS request."),(0,i.kt)("p",null,"The server-side HTTP headers play a crucial role in informing the browser whether the requested origin is permitted to be accessed."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"If the server does not implement any blocking and returns a response, the browser will receive the response."),(0,i.kt)("p",{parentName:"admonition"},"However, due to the same-origin policy, the browser restricts access to the response, leading to errors or restrictions in manipulating the response data.")),(0,i.kt)("p",null,"CORS requests are categorized into two types: ",(0,i.kt)("strong",{parentName:"p"},"simple requests")," and ",(0,i.kt)("strong",{parentName:"p"},"preflight requests"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Simple Requests")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Requests made using the ",(0,i.kt)("inlineCode",{parentName:"p"},"GET"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"HEAD"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," methods are considered ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests"},"simple requests"),"\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"For a simple request, the browser directly sends the request to the server and automatically includes the origin of the request in the request's headers.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The server's response can include the ",(0,i.kt)("strong",{parentName:"p"},"Access-Control-Allow-Origin")," header, which can specify either a specific origin or a wildcard (","*",") to indicate that any origin is allowed."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"// specify a specific origin is allowed\n// Access-Control-Allow-Origin: https://jordantseng.github.io\n\n// a wildcard * to indicate that any origin is allowed\n// Access-Control-Allow-Origin:\uff0a\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Preflight Requests")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Whenever a request does not meet the conditions for a simple request, the browser always initiates an additional HTTP request known as a ",(0,i.kt)("strong",{parentName:"p"},"preflight request"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The method used for a preflight request is ",(0,i.kt)("strong",{parentName:"p"},"OPTIONS"),". Once the preflight request is successfully completed, the actual request is then sent."))),(0,i.kt)("p",null,"FAQ: Why do we need preflight requests? Isn't it wasteful to have an extra request before the actual one \ud83e\udd14"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Although the same-origin policy doesn't block requests, it does block responses.")," This means that if a malicious user sends a ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETE")," request, the same-origin policy won't stop the request itself."),(0,i.kt)("p",null,"In other words, without an extra layer of protection, the attacker could freely send ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETE")," requests and potentially delete server-side resources."),(0,i.kt)("p",null,"Preflight requests act as an additional layer of filtering. Only when the preflight request successfully passes, the actual request is then sent to the server."),(0,i.kt)("h3",{id:"how-to-resolve-cors"},"How to resolve CORS"),(0,i.kt)("p",null,"TL;DR: Ask the backend engineer to configure the CORS headers on the server-side."),(0,i.kt)("p",null,"When encountering CORS issues, the following steps can be followed:"),(0,i.kt)("p",null,"Simple requests:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Add the ",(0,i.kt)("inlineCode",{parentName:"li"},"Access-Control-Allow-Origin")," header to the backend's ",(0,i.kt)("inlineCode",{parentName:"li"},"GET")," / ",(0,i.kt)("inlineCode",{parentName:"li"},"HEAD")," / ",(0,i.kt)("inlineCode",{parentName:"li"},"POST")," methods.")),(0,i.kt)("p",null,"Non-simple requests:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Implement an ",(0,i.kt)("inlineCode",{parentName:"li"},"OPTIONS")," method on the server to handle preflight requests."),(0,i.kt)("li",{parentName:"ol"},"In the ",(0,i.kt)("inlineCode",{parentName:"li"},"OPTIONS")," response, include the ",(0,i.kt)("inlineCode",{parentName:"li"},"Access-Control-Allow-Methods")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"Access-Control-Allow-Headers")," headers."),(0,i.kt)("li",{parentName:"ol"},"Include the ",(0,i.kt)("inlineCode",{parentName:"li"},"Access-Control-Allow-Origin")," header in the responses of backend methods handling the actual requests.")),(0,i.kt)("p",null,"Reference:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://shubo.io/what-is-cors/#%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96-same-origin-policy"},"https://shubo.io/what-is-cors/#\u540c\u6e90\u653f\u7b56-same-origin-policy")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://www.explainthis.io/zh-hant/interview-guides/browser/what-is-cors"},"https://www.explainthis.io/zh-hant/interview-guides/browser/what-is-cors"))))}d.isMDXComponent=!0}}]);